### why

一个独立的工具，兼容性的操作，比如 不同的 css 添加前缀

1. postcss 是什么：使用 js 转换样式的工具
2. less(less-loader) --> css --> css-loader

### 安装

```js
$ npm i -D postcss      // 整体工具，解析器
$ npm i -D postcss-cli  // 可以在命令行进行使用了，理解之后还是放在webpack的配置文件中
$ npm i -D autoprefixer // 具体的功能，对样式进行添加前缀
```

https://autoprefixer.github.io

```js
.example {
  // 不是每个平台都支持，需要自己添加前缀 -- postcss
    display: grid;
    transition: all .5s;
    user-select: none;
    background: linear-gradient(to bottom, white, black);
}
```

```js
// 默认读取当前目录的 .browserslistrc
// 这样打包出来的css文件就有前缀了（根据条件）
$ npx postcss --use autoprefixer -o ret.css ./src/test.css
```

### postcss-loader

```js
$ npm i -D postcss-loader
```

postcss-loader 使用 autoprefixer 添加前缀

css-loader 生成 css

style-loader 添加到项目进行展示

```js
// webpack.config.js
const path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "build.js", // 打包结果的文件名称
    path: path.resolve(__dirname, "dist"), // 路径，只能是绝对路径
  },
  module: {
    rules: [
      // {
      //   test: /\.css$/, // 一般就是一个正则表达式，用于匹配要处理的文件类型, \是转移， $表示结尾
      //   use: [
      //     {
      //       loader: "css-loader", // 表示要用的loader
      //       // options: // 字符串或着对象，可选参数，用户传进来特定的配置参数
      //       // query: // webpack5 里已经合并到options里面了
      //     },
      //   ],
      // },
      // {
      //   test: /\.css$/,
      //   loader: 'css-loader'
      // },    // 上面的简写，只有一个loader，且没有什么配置参数，完全可以简写
      {
        test: /\.css$/,
        use: [
          "style-loader",
          "css-loader",
          {
            loader: "postcss-loader",
            options: {
              postcssOptions: {
                plugins: [require("autoprefixer")],
              },
            },
          },
        ], // 执行顺序是从后向前
      }, // 另一种简写形式，有多个loader，并且不需要配置参数
      {
        test: /\.less$/,
        use: ["style-loader", "css-loader", "less-loader"], // 执行顺序是从后向前
      },
    ],
  },
};
```

### postcss-preset-env

预设 -- 插件集合（ autoprefixer 这是一个插件）

```js
.title {
  // rgba，想要转换成这种形似需要其它插件
  color: #12345678;
}
```

autoprefixer 这只有一个功能，如果我们想转换 color 的 rgba，还需要其它插件，这个时候我们可以使用插件集合，默认给我们放了很多常用的功能 -- `postcss-preset-env`

```js
$ npm i -D postcss-preset-env
```

```js
// webpack.config.js
const path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "build.js", // 打包结果的文件名称
    path: path.resolve(__dirname, "dist"), // 路径，只能是绝对路径
  },
  module: {
    rules: [
      // {
      //   test: /\.css$/, // 一般就是一个正则表达式，用于匹配要处理的文件类型, \是转移， $表示结尾
      //   use: [
      //     {
      //       loader: "css-loader", // 表示要用的loader
      //       // options: // 字符串或着对象，可选参数，用户传进来特定的配置参数
      //       // query: // webpack5 里已经合并到options里面了
      //     },
      //   ],
      // },
      // {
      //   test: /\.css$/,
      //   loader: 'css-loader'
      // },    // 上面的简写，只有一个loader，且没有什么配置参数，完全可以简写
      {
        test: /\.css$/,
        use: [
          "style-loader",
          "css-loader",
          {
            loader: "postcss-loader",
            options: {
              postcssOptions: {
                // plugins: [
                //   require("autoprefixer")
                //   require("postcss-preset-env")
                // ],
                plugins: ["postcss-preset-env"], // 简写，但不是所有的都可以是字符串，postcss-preset-env 包含 autoprefixer ，所以可以省略
              },
            },
          },
        ], // 执行顺序是从后向前
      }, // 另一种简写形式，有多个loader，并且不需要配置参数
      {
        test: /\.less$/,
        use: [
          "style-loader",
          "css-loader",
          {
            loader: "postcss-loader", // 因为是处理 css，所以需要放在less-loader 处理好的文件后面
            options: {
              postcssOptions: {
                // plugins: [
                //   require("autoprefixer")
                //   require("postcss-preset-env")
                // ],
                plugins: ["postcss-preset-env"], // 简写，但不是所有的都可以是字符串，postcss-preset-env 包含 autoprefixer ，所以可以省略
              },
            },
          },
          "less-loader",
        ], // 执行顺序是从后向前
      },
    ],
  },
};
```

### postcss.config.js

在根目录下创建 postcss.config.js 文件（名字固定），提出通用的配置

```js
module.exports = {
  plugins: [require("postcss-preset-env")],
};
```

```js
// webpack.config.js
const path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "build.js", // 打包结果的文件名称
    path: path.resolve(__dirname, "dist"), // 路径，只能是绝对路径
  },
  module: {
    rules: [
      // {
      //   test: /\.css$/, // 一般就是一个正则表达式，用于匹配要处理的文件类型, \是转移， $表示结尾
      //   use: [
      //     {
      //       loader: "css-loader", // 表示要用的loader
      //       // options: // 字符串或着对象，可选参数，用户传进来特定的配置参数
      //       // query: // webpack5 里已经合并到options里面了
      //     },
      //   ],
      // },
      // {
      //   test: /\.css$/,
      //   loader: 'css-loader'
      // },    // 上面的简写，只有一个loader，且没有什么配置参数，完全可以简写
      {
        test: /\.css$/,
        use: ["style-loader", "css-loader", "postcss-loader"], // 执行顺序是从后向前
      }, // 另一种简写形式，有多个loader，并且不需要配置参数
      {
        test: /\.less$/,
        // 因为配置文件提取到了 postcss.config.js 中（0005.md），所以 "postcss-loader" 直接写在这就可以了
        use: ["style-loader", "css-loader", "postcss-loader", "less-loader"], // 执行顺序是从后向前
      },
    ],
  },
};
```
