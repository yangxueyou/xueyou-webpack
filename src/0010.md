### asset 处理图片

在 webpack5 之前，我们处理图片这样的资源，需要用 url-loader，file-loader，row-loader

在 webpack5 之后，我们就可以使用 asset module type （资源类型模块），来简化上面 loader 的使用或者替换，是一个内置模块

- asset/resource 相当于 file-loader
- asset/inline 相当于 url-loader
- asset/source 相当于 raw-loader 不常用
- asset + options 相当于在 url-loader + file-loader

### 使用

```js
// webpack.config.js
const path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "build.js", // 打包结果的文件名称
    path: path.resolve(__dirname, "dist"), // 路径，只能是绝对路径
    // assetModuleFilename: "img/[name].[hash:4][ext]", // asset模块使用，这是全局配置，可能字体也使用 asset 模块
  },
  module: {
    rules: [
      // {
      //   test: /\.css$/, // 一般就是一个正则表达式，用于匹配要处理的文件类型, \是转移， $表示结尾
      //   use: [
      //     {
      //       loader: "css-loader", // 表示要用的loader
      //       // options: // 字符串或着对象，可选参数，用户传进来特定的配置参数
      //       // query: // webpack5 里已经合并到options里面了
      //     },
      //   ],
      // },
      // {
      //   test: /\.css$/,
      //   loader: 'css-loader'
      // },    // 上面的简写，只有一个loader，且没有什么配置参数，完全可以简写
      {
        test: /\.css$/,
        use: [
          "style-loader",
          {
            loader: "css-loader",
            options: {
              importLoaders: 1, // css-loader处理过程中，发现有其它css文件时，向前找一个loader（postcss-loader），如果想找更多的就增加数字
              esModule: false, // 否则加载背景图片失败
            },
          },
          "postcss-loader",
        ], // 执行顺序是从后向前
      }, // 另一种简写形式，有多个loader，并且不需要配置参数
      {
        test: /\.less$/,
        // 因为配置文件提取到了 postcss.config.js 中（0005.md），所以 "postcss-loader" 直接写在这就可以了
        use: ["style-loader", "css-loader", "postcss-loader", "less-loader"], // 执行顺序是从后向前
      },
      // {
      //   test: /\.(png|svg|gif|jpe?g)$/, // 小括号中间表示 或 的关系，？表示 e 可有可无
      //   user: [
      //     {
      //       loader: "url-loader",
      //       /**
      //        * 常见的占位符
      //        *
      //        * 打包前后一样
      //        *
      //        * [ext]: 扩展名，文件的后缀
      //        * [name]: 文件名称
      //        * [hash]: 结合文件内容生成一个哈希值
      //        * [contentHash]: 和 hash 一样，在其它地方可能不一样
      //        * [hash:<length>]: hash 生成的文件名太长了，自己选择一个长度
      //        * [path]: 文件路径，webpack中不常用
      //        */
      //       // options: {
      //       //   name: '[name].[hash:6].[ext]',  // 打包图片的名称
      //       //   outputPath: 'img'   // 输出到 dist/img 目录里
      //       // }
      //       options: {
      //         name: "img/[name].[hash:6].[ext]", // 上面的简写
      //         limit: 25 * 1024  // 超过 25kb 就拷贝，否者就 base64 转一下
      //       },
      //     },
      //   ],
      // },
      // {
      //   test: /\.(png|svg|gif|jpe?g)$/, // 使用 webpack5 内置模块
      //   type: "asset/resource",    // 相当于 file-loader
      //   generator: {
      //     filename: "img/[name].[hash:4][ext]"
      //   }
      // },
      // {
      //   test: /\.(png|svg|gif|jpe?g)$/, // 使用 webpack5 内置模块
      //   type: "asset/inline",  // 相当于 url-loader
      // },
      {
        test: /\.(png|svg|gif|jpe?g)$/, // 使用 webpack5 内置模块
        type: "asset", // 根据条件判断使用哪种模式
        generator: {
          filename: "img/[name].[hash:4][ext]",
        },
        parser: {
          dataUrlCondition: {
            maxSize: 30 * 1024, // 大于 30kb 进行拷贝，否则直接打包进代码里
          },
        },
      },
    ],
  },
};
```

### asset 处理图标字体

```js
// webpack.config.js
const path = require("path");

module.exports = {
  entry: "./src/index.js",
  output: {
    filename: "build.js", // 打包结果的文件名称
    path: path.resolve(__dirname, "dist"), // 路径，只能是绝对路径
    // assetModuleFilename: "img/[name].[hash:4][ext]", // asset模块使用，这是全局配置，可能字体也使用 asset 模块
  },
  module: {
    rules: [
      {
        test: /\.css$/,
        use: [
          "style-loader",
          {
            loader: "css-loader",
            options: {
              importLoaders: 1, // css-loader处理过程中，发现有其它css文件时，向前找一个loader（postcss-loader），如果想找更多的就增加数字
              esModule: false, // 否则加载背景图片失败
            },
          },
          "postcss-loader",
        ], // 执行顺序是从后向前
      }, // 另一种简写形式，有多个loader，并且不需要配置参数
      {
        test: /\.less$/,
        // 因为配置文件提取到了 postcss.config.js 中（0005.md），所以 "postcss-loader" 直接写在这就可以了
        use: ["style-loader", "css-loader", "postcss-loader", "less-loader"], // 执行顺序是从后向前
      },
      {
        test: /\.(png|svg|gif|jpe?g)$/, // 使用 webpack5 内置模块
        type: "asset", // 根据条件判断使用哪种模式
        generator: {
          filename: "img/[name].[hash:4][ext]",
        },
        parser: {
          dataUrlCondition: {
            maxSize: 30 * 1024, // 大于 30kb 进行拷贝，否则直接打包进代码里
          },
        },
      },
      {
        test: /\.(ttf|woff2?)$/,  // iconfront 图标字体
        type: "asset/resource", // 直接作为静态资源拷贝出去就可以了
        generator: {
          filename: "font/[name].[hash:4][ext]",
        },
      },
    ],
  },
};
```
